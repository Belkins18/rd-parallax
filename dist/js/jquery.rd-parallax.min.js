(function(){(function(d,p,m){var n,k;k=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);/iPhone|iPad|iPod/i.test(navigator.userAgent)&&navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);navigator.appVersion.indexOf("MSIE");n=function(){function c(a,e){this.options=d.extend(!0,{},this.Defaults,e);this.$element=d(a);this.$canvas=!1;this.$win=d(m);this.$doc=d(p);this.$anchor=!1;this.initialize()}c.prototype.Defaults={blur:!0,direction:"normal",speed:1,screenAliases:{0:"",
480:"xs",768:"sm",992:"md",1200:"lg"}};c.prototype.initialize=function(){var a;a=this;a.$element.parents().each(function(){var e,b,g;g={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(b in g)g.hasOwnProperty(b)&&null!=this.style[b]&&(e=m.getComputedStyle(this).getPropertyValue(g[b]));if(null!=e&&0<e.length&&"none"!==e)return a.$anchor=d(this),!1}).end().wrapInner(d("<div/>",{"class":"rd-parallax-inner"})).find(".rd-parallax-layer[data-type]").each(function(){var e,
b;e=d(this);switch(e.attr("data-type").toLowerCase()){case "media":if(b=this.getAttribute("data-url"))e.css({"background-image":a.url(b)}),("true"===this.getAttribute("data-blur")||a.options.blur)&&d("<img/>",{src:b}).load(function(){e.attr("data-media-width",this.width);e.attr("data-media-height",this.height);if(!k)a.$win.on("resize",d.proxy(a.blurMedia,e[0],a));return d.proxy(a.blurMedia,e[0],a)()});a.$element.on("resize",d.proxy(a.resizeMedia,this,a));a.$element.on("resize",d.proxy(a.moveLayer,
this,a));if(k)a.$win.on("orientationchange",d.proxy(a.resizeMedia,this,a));else a.$win.on("resize",d.proxy(a.resizeMedia,this,a))}if(k)a.$win.on("orientationchange",d.proxy(a.moveLayer,this,a));else a.$doc.on("scroll",d.proxy(a.moveLayer,this,a)),a.$win.on("resize",d.proxy(a.moveLayer,this,a)),"true"===this.getAttribute("data-fade")&&(a.$doc.on("scroll",d.proxy(a.fadeLayer,this,a)),a.$win.on("resize",d.proxy(a.fadeLayer,this,a)))});a.$canvas=a.$element.find(".rd-parallax-inner");if("true"===a.$element.attr("data-fit-to-parent"))a.$win.on("resize",
d.proxy(a.fitCanvas,a.$canvas,a));k||(a.$win.on("resize",d.proxy(a.resizeWrap,a.$element[0],a)),a.$win.on("resize",d.proxy(a.resizeCanvas,a.$canvas[0],a)),a.$doc.on("scroll",d.proxy(a.moveCanvas,a.$canvas[0],a)),a.$win.on("resize",d.proxy(a.moveCanvas,a.$canvas[0],a)));a.$win.trigger("resize");a.$win.trigger("orientationchange");a.$doc.trigger("scroll");a.$win.load(function(){a.$win.trigger("resize");a.$win.trigger("orientationchange");return a.$doc.trigger("scroll")})};c.prototype.moveLayer=function(a){var e,
b,g,f,c,h,l;c=a.$win.scrollTop();f=a.$element.offset().top;l=a.$win.height();e=a.$element.height();b=a.$doc.height();g=this.offsetHeight;parseFloat(h);h=("inverse"===a.getAttribute(this,"direction")?-1:1)*Math.min(parseFloat(a.getAttribute(this,"speed")),2);b="media"!==this.getAttribute("data-type")?f<l||f>b-l?f<l?f/(l-e)||0:(f-b+l)/(l-e)||0:.5:.5;g=-(f-c)*h+(e-g)/2+(l-e)*b*h;if(c+l>=f&&c<=f+e)return d(this).css(a.transform(g,a))};c.prototype.moveCanvas=function(a,e){var b,g,f;b=d(this);f=a.$win.scrollTop();
g=a.$element.offset().top;g=a.$anchor?a.$element.position().top:g-f;return b.css({top:g})};c.prototype.fadeLayer=function(a,e){var b,g,f,c,h;f=d(this);b=a.$element.height();g=a.$element.offset().top+b/2;c=f.offset().top+f.height()/2;h=b/6;if(g+h>c&&g-h<c)return f.css({opacity:1});b=g-h<c?1+(g+h-c)/b/3*10:1-(g-h-c)/b/3*10;return f.css({opacity:0>b?0:1<b?1:b.toFixed(2)})};c.prototype.blurMedia=function(a){var e,b,g,c;e=this.offsetHeight;c=this.offsetWidth;b=parseFloat(this.getAttribute("data-media-height"));
g=parseFloat(this.getAttribute("data-media-width"));e=Math.ceil(Math.max(e/b,c/g));return d(this).css(a.blur(e))};c.prototype.resizeMedia=function(a){return this.style.height=a.px(a.getMediaHeight(a.$win.height(),a.$element.height(),a.getAttribute(this,"speed"),"inverse"===a.getAttribute(this,"direction")?-1:1))};c.prototype.resizeWrap=function(a){return this.style.height=a.px(a.$canvas.outerHeight())};c.prototype.resizeCanvas=function(a){return d(this).css({position:"fixed",left:a.$anchor?a.$element.offset().left-
a.$anchor.offset().left:a.$element.offset().left,width:a.$element.width()})};c.prototype.fitCanvas=function(a){return setTimeout(function(){return a.$canvas.css({height:a.$element.parent().parent().height()})})};c.prototype.getMediaHeight=function(a,e,b,c){b=Math.max(parseFloat(b),0);b=Math.min(parseFloat(b),2);return e+(-1===c?(e+a)*b:0)+(1>=b?Math.abs(a-e)*b:a*b)+56};c.prototype.url=function(a){return"url("+a+")"};c.prototype.px=function(a){return a+"px"};c.prototype.transform=function(a,c){return{"-webkit-transform":"matrix3d(1,0,0.00,0,0.00,1,0.00,0,0,0,1,0,0,"+
a+",0,1)",transform:"matrix3d(1,0,0.00,0,0.00,1,0.00,0,0,0,1,0,0,"+a+",0,1)"}};c.prototype.blur=function(a){return 3<a?{"-webkit-filter":"blur("+a+"px)",filter:"blur("+a+"px)"}:{filter:"none","-webkit-filter":"none"}};c.prototype.getAttribute=function(a,c){var b,d,f,k,h;if(null!=this.options.screenAliases)for(d=Object.keys(this.options.screenAliases).reverse(),f=k=0,h=d.length-1;(0<=h?k<=h:k>=h)&&!(b=""!==this.options.screenAliases[d[f]]?"-"+this.options.screenAliases[d[f]]:this.options.screenAliases[d[f]],
b=a.getAttribute("data"+b+"-"+c),d[f]<=this.$win.width()&&null!=b);f=0<=h?++k:--k);return null!=b?b:this.options[c]};return c}();d.fn.extend({RDParallax:function(c){return this.each(function(){var a;a=d(this);if(!a.data("RDParallax"))return a.data("RDParallax",new n(this,c))})}});return m.RDParallax=n})(window.jQuery,document,window);"undefined"!==typeof module&&null!==module?module.exports=window.RDParallax:"function"===typeof define&&define.amd&&define(["jquery"],function(){return window.RDParallax})}).call(this);
