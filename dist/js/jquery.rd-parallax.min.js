/**
 * @module       RD Parallax
 * @author       Evgeniy Gusarov
 * @see          https://ua.linkedin.com/pub/evgeniy-gusarov/8a/a40/54a
 * @version      3.6.1
 */
(function(){(function(n,m,e){var r,y,u,x,f,k,w,p,v;k=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);u=/Chrome/.test(navigator.userAgent);p=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)||/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);x=k&&/crios/i.test(navigator.userAgent);w=/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);f=-1!==navigator.appVersion.indexOf("MSIE")||
-1<navigator.appVersion.indexOf("Trident/");v=/windows nt 6.2/.test(navigator.userAgent.toLowerCase())||/windows nt 6.3/.test(navigator.userAgent.toLowerCase());y=null!=m.body.classList;(function(){var f,k,m,b,a;k=0;a=["ms","moz","webkit","o"];f=0;for(m=a.length;f<m;f++)b=a[f],e.requestAnimationFrame=e[b+"RequestAnimationFrame"],e.cancelAnimationFrame=e[b+"CancelAnimationFrame"]||e[b+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(a,c){var d,b,h;d=(new Date).getTime();
h=Math.max(0,16-(d-k));b=e.setTimeout(function(){a(d+h)},h);k=d+h;return b});if(!e.cancelAnimationFrame)return e.cancelAnimationFrame=function(a){return clearTimeout(a)}});r=function(){function t(b){this.options=n.extend(!0,{},this.Defaults,b);this.scenes=[];this.initialize();this.scrollY=e.scrollY||e.pageYOffset;this.lastScrollY=-1;this.inputFocus=!1}var z,r;z=function(){function b(a,g,c,d,b,h,l){this.amend=p||f||k?60:0;this.element=a;this.aliases=g;this.type=a.getAttribute("data-type")||"html";
"html"===this.type&&(this.holder=this.createHolder());this.direction="normal"===a.getAttribute("data-direction")||null==a.getAttribute("data-direction")?1:-1;this.fade="true"===a.getAttribute("data-fade");this.blur="true"===a.getAttribute("data-blur");this.boundTo=m.querySelector(a.getAttribute("data-bound-to"));"media"===this.type&&(this.url=a.getAttribute("data-url"));this.responsive=this.getResponsiveOptions();this.element.style.position=!f&&!k||u&&k||v&&f?"absolute":"fixed";switch(this.type){case "media":null!=
this.url&&(this.element.style["background-image"]="url("+this.url+")");break;case "html":f&&k&&(this.element.style["z-index"]=1)}this.refresh(c,d,b,h,l)}b.prototype.refresh=function(a,g,c,d,b){this.speed=this.getOption("speed",a)||0;this.offset=this.getOption("offset",a)||0;!k||u&&k||v&&f||(this.element.style.position=b?"fixed":"absolute");f&&"html"===this.type&&(this.element.style.position="absolute");switch(this.type){case "media":if(!f)return this.offsetHeight=this.getMediaHeight(g,d,this.speed,
this.direction),this.element.style.height=this.offsetHeight+"px";break;case "html":this.element.style.width=this.holder.offsetWidth+"px";this.offsetHeight=this.element.offsetHeight;this.holder.style.height=this.offsetHeight+"px";if(!(!f&&!k||u&&k||v&&f))return f?this.element.style.position="static":b&&(this.element.style.left=this.getOffset(this.holder).left+"px",this.element.style.top=this.getOffset(this.holder).top-c+"px"),this.holder.style.position="static";break;case "custom":return this.offsetHeight=
this.element.offsetHeight}};b.prototype.createHolder=function(){var a;a=m.createElement("div");y?a.classList.add("rd-parallax-layer-holder"):a.className="rd-parallax-layer-holder";this.element.parentNode.insertBefore(a,this.element);a.appendChild(this.element);if(!f&&!k||x)a.style.position="relative";return a};b.prototype.getOption=function(a,g){var c,d;for(c in this.responsive)c<=g&&(d=c);return this.responsive[d][a]};b.prototype.getResponsiveOptions=function(){var a,g,c,d,b,h,l,e,f;e={};l=[];g=
[];d=this.aliases;for(c in d)a=d[c],l.push(c),g.push(a);c=d=0;for(b=l.length;d<b;c=++d)for(h=l[c],e[h]={};-1<=(a=c);)!e[h].speed&&(f=this.element.getAttribute("data"+g[a]+"speed"))&&(e[h].speed=this.getSpeed(f)),!e[h].offset&&(f=this.element.getAttribute("data"+g[a]+"offset"))&&(e[h].offset=parseInt(f)),c--;return e};b.prototype.fuse=function(a,g){var c,d,b;c=this.getOffset(this.element).top+this.element.getBoundingClientRect().top;d=a+g/2;c+=this.offsetHeight/2;b=g/6;d+b>c&&d-b<c?this.element.style.opacity=
1:(d=d-b<c?1+(d+b-c)/g/3*10:1-(d-b-c)/g/3*10,this.element.style.opacity=0>d?0:1<d?1:d.toFixed(2))};b.prototype.move=function(a,g,c,d,b,h,e,q,m){f&&"media"===this.type||u&&k||v&&f||(e?(e=!k||"html"===this.type&&m||x?this.speed*this.direction:this.speed*this.direction-1,g=this.offsetHeight,null!=q?h=(d+c-(q+c))/(c-b):"media"!==this.type?d<c||d>h-c?(h=d<c?d/(c-b):(d+c-h)/(c-b),isFinite(h)||(h=0)):h=.5:h=.5,a=x||f?(b-g)/2+(c-b)*h*e+this.offset:k?-(d-a)*e+(b-g)/2+(c-b)*h*(e+1)+this.offset:-(d-a)*e+(b-
g)/2+(c-b)*h*e+this.offset,k&&null!=q&&(this.element.style.top=d-q+"px"),w&&m&&(a+=d),p&&(this.element.style["-webkit-transform"]="translate3d(0,"+a+"px,0)"),this.element.style.transform="translate3d(0,"+a+"px,0)"):(p&&(this.element.style["-webkit-transform"]="translate3d(0,0,0)"),this.element.style.transform="translate3d(0,0,0)"))};b.prototype.getSpeed=function(a){return Math.min(Math.max(parseFloat(a),0),2)};b.prototype.getMediaHeight=function(a,b,c,d){return b+(-1===d?(b+a)*c:0)+(1>=c?Math.abs(a-
b)*c:a*c)+2*this.amend};b.prototype.getOffset=function(a){a=a.getBoundingClientRect();return{top:a.top+(e.scrollY||e.pageYOffset),left:a.left+(e.scrollX||e.pageXOffset)}};return b}();r=function(){function b(a,b,c,d){this.amend=p?60:0;this.element=a;this.aliases=b;this.on=!0;this.agent=m.querySelector(a.getAttribute("data-agent"));this.anchor=this.findAnchor();this.canvas=this.createCanvas();this.layers=this.createLayers(c);this.fitTo=this.getFitElement();this.responsive=this.getResponsiveOptions();
this.refresh(c,d)}b.prototype.getFitElement=function(){var a;return null!=(a=this.element.getAttribute("data-fit-to"))?"parent"===a?this.element.parentNode:m.querySelector(a):null};b.prototype.findAnchor=function(){var a;for(a=this.element.parentNode;null!=a&&a!==m;){if(this.isTransformed.call(a))return a;a=a.parentNode}return null};b.prototype.createCanvas=function(){var a;a=m.createElement("div");y?a.classList.add("rd-parallax-inner"):a.className="rd-parallax-inner";for(this.element.appendChild(a);this.element.firstChild!==
a;)a.appendChild(this.element.firstChild);this.element.style.position="relative";this.element.style.overflow="hidden";f||k?(a.style.position="absolute",v&&f||(a.style.clip="rect(0, auto, auto, 0)"),a.style.transform=f?"translate3d(0,0,0)":"none"):a.style.position="fixed";a.style.left=this.offsetLeft+"px";a.style.top=0;p&&(a.style["margin-top"]="-"+this.amend+"px",a.style.padding=this.amend+"px 0",this.element.style["z-index"]=0);return a};b.prototype.getOption=function(a,b){var c,d;for(c in this.responsive)c<=
b&&(d=c);return this.responsive[d][a]};b.prototype.getResponsiveOptions=function(){var a,b,c,d,e,h,l,f,k;f={};l=[];b=[];d=this.aliases;for(c in d)a=d[c],l.push(c),b.push(a);c=d=0;for(e=l.length;d<e;c=++d)for(h=l[c],f[h]={};-1<=(a=c);)f[h].on||null==(k=this.element.getAttribute("data"+b[a]+"on"))||(f[h].on="false"!==k),null==f[h].on&&0===a&&(f[h].on=!0),c--;return f};b.prototype.createLayers=function(a,b){var c,d,e,h,f;d=n(this.element).find(".rd-parallax-layer").get();h=[];c=e=0;for(f=d.length;e<
f;c=++e)c=d[c],h.push(new z(c,this.aliases,a,b,this.offsetTop,this.offsetHeight,this.on));return h};b.prototype.move=function(a){a=null!=this.anchor?this.positionTop:this.offsetTop-a;p&&(this.canvas.style["-webkit-transform"]="translate3d(0,"+a+"px,0)");return this.canvas.style.transform="translate3d(0,"+a+"px,0)"};b.prototype.refresh=function(a,b){var c,d,e,h,f;h=[];this.on=this.getOption("on",a);this.offsetTop=this.getOffset(this.element).top;this.offsetLeft=this.getOffset(this.element).left;this.width=
this.element.offsetWidth;this.canvas.style.width=this.width+"px";null!=this.anchor&&(this.positionTop=this.element.offsetTop);null!=this.agent?(this.agentOffset=this.getOffset(this.agent).top,this.agentHeight=this.agent.offsetHeight):this.agentOffset=this.agentHeight=null;f=this.layers;c=0;for(e=f.length;c<e;c++)d=f[c],"media"===d.type?h.push(d):d.refresh(a,b,this.offsetTop,this.offsetHeight,this.on);this.offsetHeight=this.canvas.offsetHeight-2*this.amend;this.element.style.height=this.offsetHeight+
"px";c=0;for(e=h.length;c<e;c++)d=h[c],d.refresh(a,b,this.offsetTop,this.offsetHeight,this.on)};b.prototype.update=function(a,b,c,d,e){var h,l,m,n,p,t,r;r=this.offsetTop;t=this.offsetHeight;f||k||this.move(a);n=this.layers;p=[];h=0;for(m=n.length;h<m;h++)l=n[h],l.move(a,b,c,r,t,d,this.on,this.agentOffset,e),!l.fade||k||f?p.push(void 0):p.push(l.fuse(r,t));return p};b.prototype.isTransformed=function(){var a,b,c;c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",
MozTransform:"-moz-transform",transform:"transform"};for(a in c)c.hasOwnProperty(a)&&null!=this.style[a]&&(b=e.getComputedStyle(this).getPropertyValue(c[a]));return null!=b&&0<b.length&&"none"!==b?!0:!1};b.prototype.getOffset=function(a){a=a.getBoundingClientRect();return{top:a.top+(e.scrollY||e.pageYOffset),left:a.left+(e.scrollX||e.pageYOffset)}};return b}();t.prototype.Defaults={selector:".rd-parallax",screenAliases:{0:"-",480:"-xs-",768:"-sm-",992:"-md-",1200:"-lg-",1920:"-xl-",2560:"-xxl-"}};
t.prototype.initialize=function(){var b,a,g,c,d,f,h;b=this;g=m.querySelectorAll(b.options.selector);h=e.innerWidth;f=e.innerHeight;a=c=0;for(d=g.length;c<d;a=++c)a=g[a],b.scenes.push(new r(a,b.options.screenAliases,h,f));n(e).on("resize",n.proxy(b.resize,b));if(w)n("input").on("focusin focus",function(a){a.preventDefault();b.activeOffset=n(this).offset().top;return e.scrollTo(e.scrollX||e.pageXOffset,b.activeOffset-this.offsetHeight-100)});n(e).trigger("resize");b.update()};t.prototype.resize=function(){var b,
a,g,c;if((b=e.innerWidth)!==this.windowWidth||!k){this.windowWidth=b;this.windowHeight=e.innerHeight;this.documentHeight=m.body.offsetHeight;g=this.scenes;b=0;for(a=g.length;b<a;b++)c=g[b],c.refresh(this.windowWidth,this.windowHeight);return this.update(!0)}};t.prototype.update=function(b){var a,g,c,d,f,h,l,q,n,p;g=this;b||requestAnimationFrame(function(){g.update()});q=e.scrollY||e.pageYOffset;w&&null!=(a=m.activeElement)&&(a.tagName.match(/(input)|(select)|(textarea)/i)?(g.activeElement=a,g.inputFocus=
!0):(g.activeElement=null,g.inputFocus=!1,b=!0));k&&u&&(a=e.innerHeight-g.windowHeight,g.deltaHeight=a,q-=g.deltaHeight);if((q!==g.lastScrollY||b)&&!g.isActing){g.isActing=!0;p=g.windowWidth;n=g.windowHeight;c=g.documentHeight;a=q-g.lastScrollY;w&&null!=g.activeElement&&(g.activeElement.value+=" ",g.activeElement.value=g.activeElement.value.trim());h=g.scenes;d=0;for(f=h.length;d<f;d++)l=h[d],(g.inputFocus||b||q+n>=(l.agentOffset||l.offsetTop)+a&&q<=(l.agentOffset||l.offsetTop)+(l.agentHeight||l.offsetHeight)+
a)&&l.update(q,p,n,c,g.inputFocus);g.lastScrollY=q;return g.isActing=!1}};return t}();n.RDParallax=function(e){var f;f=n(m);if(!f.data("RDParallax"))return f.data("RDParallax",new r(e))};return e.RDParallax=r})(window.jQuery,document,window);"undefined"!==typeof module&&null!==module?module.exports=window.RDParallax:"function"===typeof define&&define.amd&&define(["jquery"],function(){return window.RDParallax})}).call(this);
