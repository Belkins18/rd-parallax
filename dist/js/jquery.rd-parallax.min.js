/**
 * @module       RD Parallax
 * @author       Evgeniy Gusarov
 * @see          https://ua.linkedin.com/pub/evgeniy-gusarov/8a/a40/54a
 * @version      3.6.0
 */
(function(){(function(n,m,e){var r,x,u,w,k,h,v,p;h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);u=/Chrome/.test(navigator.userAgent);p=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)||/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);w=h&&/crios/i.test(navigator.userAgent);v=/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);k=-1!==navigator.appVersion.indexOf("MSIE")||
0<navigator.appVersion.indexOf("Trident/");x=null!=m.body.classList;(function(){var h,k,m,b,a;k=0;a=["ms","moz","webkit","o"];h=0;for(m=a.length;h<m;h++)b=a[h],e.requestAnimationFrame=e[b+"RequestAnimationFrame"],e.cancelAnimationFrame=e[b+"CancelAnimationFrame"]||e[b+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(a,c){var d,b,g;d=(new Date).getTime();g=Math.max(0,16-(d-k));b=e.setTimeout(function(){a(d+g)},g);k=d+g;return b});if(!e.cancelAnimationFrame)return e.cancelAnimationFrame=
function(a){return clearTimeout(a)}});r=function(){function t(b){this.options=n.extend(!0,{},this.Defaults,b);this.scenes=[];this.initialize();this.scrollY=e.scrollY||e.pageYOffset;this.lastScrollY=-1;this.inputFocus=!1}var y,r;y=function(){function b(a,f,c,d,b,g,l){this.amend=p||k||h?60:0;this.element=a;this.aliases=f;this.type=a.getAttribute("data-type")||"html";"html"===this.type&&(this.holder=this.createHolder());this.direction="normal"===a.getAttribute("data-direction")||null==a.getAttribute("data-direction")?
1:-1;this.fade="true"===a.getAttribute("data-fade");this.blur="true"===a.getAttribute("data-blur");this.boundTo=m.querySelector(a.getAttribute("data-bound-to"));"media"===this.type&&(this.url=a.getAttribute("data-url"));this.responsive=this.getResponsiveOptions();this.element.style.position=!k&&!h||u&&h?"absolute":"fixed";switch(this.type){case "media":null!=this.url&&(this.element.style["background-image"]="url("+this.url+")");break;case "html":k&&h&&(this.element.style["z-index"]=1)}this.refresh(c,
d,b,g,l)}b.prototype.refresh=function(a,f,c,d,b){this.speed=this.getOption("speed",a)||0;this.offset=this.getOption("offset",a)||0;!h||u&&h||(this.element.style.position=b?"fixed":"absolute");k&&"html"===this.type&&(this.element.style.position="absolute");switch(this.type){case "media":if(!k)return this.offsetHeight=this.getMediaHeight(f,d,this.speed,this.direction),this.element.style.height=this.offsetHeight+"px";break;case "html":this.element.style.width=this.holder.offsetWidth+"px";this.offsetHeight=
this.element.offsetHeight;this.holder.style.height=this.offsetHeight+"px";if(!(!k&&!h||u&&h))return k?this.element.style.position="static":b&&(this.element.style.left=this.getOffset(this.holder).left+"px",this.element.style.top=this.getOffset(this.holder).top-c+"px"),this.holder.style.position="static";break;case "custom":return this.offsetHeight=this.element.offsetHeight}};b.prototype.createHolder=function(){var a;a=m.createElement("div");x?a.classList.add("rd-parallax-layer-holder"):a.className=
"rd-parallax-layer-holder";this.element.parentNode.insertBefore(a,this.element);a.appendChild(this.element);if(!k&&!h||w)a.style.position="relative";return a};b.prototype.getOption=function(a,f){var c,d;for(c in this.responsive)c<=f&&(d=c);return this.responsive[d][a]};b.prototype.getResponsiveOptions=function(){var a,f,c,d,b,g,l,e,h;e={};l=[];f=[];d=this.aliases;for(c in d)a=d[c],l.push(c),f.push(a);c=d=0;for(b=l.length;d<b;c=++d)for(g=l[c],e[g]={};-1<=(a=c);)!e[g].speed&&(h=this.element.getAttribute("data"+
f[a]+"speed"))&&(e[g].speed=this.getSpeed(h)),!e[g].offset&&(h=this.element.getAttribute("data"+f[a]+"offset"))&&(e[g].offset=parseInt(h)),c--;return e};b.prototype.fuse=function(a,f){var c,d,b;c=this.getOffset(this.element).top+this.element.getBoundingClientRect().top;d=a+f/2;c+=this.offsetHeight/2;b=f/6;d+b>c&&d-b<c?this.element.style.opacity=1:(d=d-b<c?1+(d+b-c)/f/3*10:1-(d-b-c)/f/3*10,this.element.style.opacity=0>d?0:1<d?1:d.toFixed(2))};b.prototype.move=function(a,f,c,d,b,g,e,q,m){k&&"media"===
this.type||u&&h||(e?(e=!h||"html"===this.type&&m||w?this.speed*this.direction:this.speed*this.direction-1,f=this.offsetHeight,null!=q?g=(d+c-(q+c))/(c-b):"media"!==this.type?d<c||d>g-c?(g=d<c?d/(c-b):(d+c-g)/(c-b),isFinite(g)||(g=0)):g=.5:g=.5,a=w||k?(b-f)/2+(c-b)*g*e+this.offset:h?-(d-a)*e+(b-f)/2+(c-b)*g*(e+1)+this.offset:-(d-a)*e+(b-f)/2+(c-b)*g*e+this.offset,h&&null!=q&&(this.element.style.top=d-q+"px"),v&&m&&(a+=d),p&&(this.element.style["-webkit-transform"]="translate3d(0,"+a+"px,0)"),this.element.style.transform=
"translate3d(0,"+a+"px,0)"):(p&&(this.element.style["-webkit-transform"]="translate3d(0,0,0)"),this.element.style.transform="translate3d(0,0,0)"))};b.prototype.getSpeed=function(a){return Math.min(Math.max(parseFloat(a),0),2)};b.prototype.getMediaHeight=function(a,b,c,d){return b+(-1===d?(b+a)*c:0)+(1>=c?Math.abs(a-b)*c:a*c)+2*this.amend};b.prototype.getOffset=function(a){a=a.getBoundingClientRect();return{top:a.top+(e.scrollY||e.pageYOffset),left:a.left+(e.scrollX||e.pageXOffset)}};return b}();r=
function(){function b(a,b,c,d){this.amend=p?60:0;this.element=a;this.aliases=b;this.on=!0;this.agent=m.querySelector(a.getAttribute("data-agent"));this.anchor=this.findAnchor();this.canvas=this.createCanvas();this.layers=this.createLayers(c);this.fitTo=this.getFitElement();this.responsive=this.getResponsiveOptions();this.refresh(c,d)}b.prototype.getFitElement=function(){var a;return null!=(a=this.element.getAttribute("data-fit-to"))?"parent"===a?this.element.parentNode:m.querySelector(a):null};b.prototype.findAnchor=
function(){var a;for(a=this.element.parentNode;null!=a&&a!==m;){if(this.isTransformed.call(a))return a;a=a.parentNode}return null};b.prototype.createCanvas=function(){var a;a=m.createElement("div");x?a.classList.add("rd-parallax-inner"):a.className="rd-parallax-inner";for(this.element.appendChild(a);this.element.firstChild!==a;)a.appendChild(this.element.firstChild);this.element.style.position="relative";this.element.style.overflow="hidden";k||h?(a.style.position="absolute",a.style.clip="rect(0, auto, auto, 0)",
a.style.transform=k?"translate3d(0,0,0)":"none"):a.style.position="fixed";a.style.left=this.offsetLeft+"px";a.style.top=0;p&&(a.style["margin-top"]="-"+this.amend+"px",a.style.padding=this.amend+"px 0",this.element.style["z-index"]=0);return a};b.prototype.getOption=function(a,b){var c,d;for(c in this.responsive)c<=b&&(d=c);return this.responsive[d][a]};b.prototype.getResponsiveOptions=function(){var a,b,c,d,e,g,l,h,k;h={};l=[];b=[];d=this.aliases;for(c in d)a=d[c],l.push(c),b.push(a);c=d=0;for(e=
l.length;d<e;c=++d)for(g=l[c],h[g]={};-1<=(a=c);)h[g].on||null==(k=this.element.getAttribute("data"+b[a]+"on"))||(h[g].on="false"!==k),null==h[g].on&&0===a&&(h[g].on=!0),c--;return h};b.prototype.createLayers=function(a,b){var c,d,e,g,h;d=n(this.element).find(".rd-parallax-layer").get();g=[];c=e=0;for(h=d.length;e<h;c=++e)c=d[c],g.push(new y(c,this.aliases,a,b,this.offsetTop,this.offsetHeight,this.on));return g};b.prototype.move=function(a){a=null!=this.anchor?this.positionTop:this.offsetTop-a;p&&
(this.canvas.style["-webkit-transform"]="translate3d(0,"+a+"px,0)");return this.canvas.style.transform="translate3d(0,"+a+"px,0)"};b.prototype.refresh=function(a,b){var c,d,e,g,h;g=[];this.on=this.getOption("on",a);this.offsetTop=this.getOffset(this.element).top;this.offsetLeft=this.getOffset(this.element).left;this.width=this.element.offsetWidth;this.canvas.style.width=this.width+"px";null!=this.anchor&&(this.positionTop=this.element.offsetTop);null!=this.agent?(this.agentOffset=this.getOffset(this.agent).top,
this.agentHeight=this.agent.offsetHeight):this.agentOffset=this.agentHeight=null;h=this.layers;c=0;for(e=h.length;c<e;c++)d=h[c],"media"===d.type?g.push(d):d.refresh(a,b,this.offsetTop,this.offsetHeight,this.on);this.offsetHeight=this.canvas.offsetHeight-2*this.amend;this.element.style.height=this.offsetHeight+"px";c=0;for(e=g.length;c<e;c++)d=g[c],d.refresh(a,b,this.offsetTop,this.offsetHeight,this.on)};b.prototype.update=function(a,b,c,d,e){var g,l,m,n,p,t,r;r=this.offsetTop;t=this.offsetHeight;
k||h||this.move(a);n=this.layers;p=[];g=0;for(m=n.length;g<m;g++)l=n[g],l.move(a,b,c,r,t,d,this.on,this.agentOffset,e),!l.fade||h||k?p.push(void 0):p.push(l.fuse(r,t));return p};b.prototype.isTransformed=function(){var a,b,c;c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(a in c)c.hasOwnProperty(a)&&null!=this.style[a]&&(b=e.getComputedStyle(this).getPropertyValue(c[a]));return null!=b&&0<b.length&&
"none"!==b?!0:!1};b.prototype.getOffset=function(a){a=a.getBoundingClientRect();return{top:a.top+(e.scrollY||e.pageYOffset),left:a.left+(e.scrollX||e.pageYOffset)}};return b}();t.prototype.Defaults={selector:".rd-parallax",screenAliases:{0:"-",480:"-xs-",768:"-sm-",992:"-md-",1200:"-lg-",1920:"-xl-",2560:"-xxl-"}};t.prototype.initialize=function(){var b,a,f,c,d,h,g;b=this;f=m.querySelectorAll(b.options.selector);g=e.innerWidth;h=e.innerHeight;a=c=0;for(d=f.length;c<d;a=++c)a=f[a],b.scenes.push(new r(a,
b.options.screenAliases,g,h));n(e).on("resize",n.proxy(b.resize,b));if(v)n("input").on("focusin focus",function(a){a.preventDefault();b.activeOffset=n(this).offset().top;return e.scrollTo(e.scrollX||e.pageXOffset,b.activeOffset-this.offsetHeight-100)});n(e).trigger("resize");b.update()};t.prototype.resize=function(){var b,a,f,c;if((b=e.innerWidth)!==this.windowWidth||!h){this.windowWidth=b;this.windowHeight=e.innerHeight;this.documentHeight=m.body.offsetHeight;f=this.scenes;b=0;for(a=f.length;b<a;b++)c=
f[b],c.refresh(this.windowWidth,this.windowHeight);return this.update(!0)}};t.prototype.update=function(b){var a,f,c,d,k,g,l,q,n,p;f=this;b||requestAnimationFrame(function(){f.update()});q=e.scrollY||e.pageYOffset;v&&null!=(a=m.activeElement)&&(a.tagName.match(/(input)|(select)|(textarea)/i)?(f.activeElement=a,f.inputFocus=!0):(f.activeElement=null,f.inputFocus=!1,b=!0));h&&u&&(a=e.innerHeight-f.windowHeight,f.deltaHeight=a,q-=f.deltaHeight);if((q!==f.lastScrollY||b)&&!f.isActing){f.isActing=!0;p=
f.windowWidth;n=f.windowHeight;c=f.documentHeight;a=q-f.lastScrollY;v&&null!=f.activeElement&&(f.activeElement.value+=" ",f.activeElement.value=f.activeElement.value.trim());g=f.scenes;d=0;for(k=g.length;d<k;d++)l=g[d],(f.inputFocus||b||q+n>=(l.agentOffset||l.offsetTop)+a&&q<=(l.agentOffset||l.offsetTop)+(l.agentHeight||l.offsetHeight)+a)&&l.update(q,p,n,c,f.inputFocus);f.lastScrollY=q;return f.isActing=!1}};return t}();n.RDParallax=function(e){var h;h=n(m);if(!h.data("RDParallax"))return h.data("RDParallax",
new r(e))};return e.RDParallax=r})(window.jQuery,document,window);"undefined"!==typeof module&&null!==module?module.exports=window.RDParallax:"function"===typeof define&&define.amd&&define(["jquery"],function(){return window.RDParallax})}).call(this);
